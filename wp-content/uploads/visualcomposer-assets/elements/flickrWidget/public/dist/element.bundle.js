vcvWebpackJsonp([1],{"./flickrWidget/component.js":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var s=n("./node_modules/babel-runtime/helpers/extends.js"),i=r(s),a=n("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),l=r(a),o=n("./node_modules/babel-runtime/helpers/classCallCheck.js"),c=r(o),p=n("./node_modules/babel-runtime/helpers/createClass.js"),u=r(p),d=n("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),m=r(d),v=n("./node_modules/babel-runtime/helpers/inherits.js"),f=r(v),h=n("./node_modules/react/react.js"),y=r(h),b=n("./node_modules/vc-cake/index.js"),g=r(b),k=g["default"].getService("api"),w=function(e){function t(e){(0,c["default"])(this,t);var n=(0,m["default"])(this,(t.__proto__||(0,l["default"])(t)).call(this,e));return n.renderScript=n.renderScript.bind(n),n}return(0,f["default"])(t,e),(0,u["default"])(t,[{key:"componentDidMount",value:function(){this.renderScript(this.props.id,this.props.atts)}},{key:"componentWillUpdate",value:function(e){this.renderScript(e.id,e.atts)}},{key:"renderScript",value:function(e,t){if(this.wrapperDiv&&(this.wrapperDiv.innerHTML=""),!t.apiKey||!t.flickrUrl||!t.count||t.count>500||t.count<1||t.columns<1||t.gap<0||!t.columns||!t.gap){var n=document.createElement("vcvhelper");return n.innerHTML="To use Flickr widget you will need to request your API key.",void this.wrapperDiv.appendChild(n)}var r="";r="round"===t.shape?"50%":"rounded"===t.shape?"10px":"0px";var s="",i="";t.flickrUrl.indexOf("/photos/")>=0?(s="User",i="people"):t.flickrUrl.indexOf("/groups/")>=0&&(s="Group",i="groups.pools");var a=document.createElement("vcvhelper"),l=document.createElement("script");l.type="text/javascript",l.setAttribute("id","vcv-script-"+e),l.text="\n    (function() {\n      var script = document.getElementById('vcv-script-"+e+"');\n      script.parentElement.style.fontSize = '0'\n      var elems = [];\n      for (var i = 0; i < "+t.count+"; i++) {\n        var newElem = document.createElement('div');\n        newElem.setAttribute('class','vce-flickr-widget-item');\n        newElem.style.width = '100%';\n        newElem.style.paddingBottom = '100%';\n        newElem.style.backgroundSize = 'cover';\n        newElem.style.display = 'inline-block';\n        newElem.style.backgroundPosition = 'center';\n        newElem.style.backgroundRepeat= 'no-repeat';\n        newElem.style.borderRadius = '"+r+"'\n        var wrapperEl = document.createElement('div');\n        wrapperEl.style.width = (100 / "+t.columns+") + '%';\n        wrapperEl.style.padding = '"+t.gap/2+"px';\n        wrapperEl.style.display = 'inline-block';\n        wrapperEl.setAttribute('class','vce-flickr-widget-wrapper');\n        wrapperEl.appendChild(newElem);\n        script.parentElement.appendChild(wrapperEl);\n        elems.push(newElem);\n      }\n      var typeRes = undefined;\n      var typeXhr = new XMLHttpRequest();\n      typeXhr.open('GET', 'https://api.flickr.com/services/rest/?method=flickr.urls.lookup"+s+"&url="+t.flickrUrl+"&format=json&api_key="+t.apiKey+"&nojsoncallback=1');\n      typeXhr.send(null);\n      typeXhr.onreadystatechange = function () {\n        var DONE = 4;\n        var OK = 200;\n        if (typeXhr.readyState === DONE) {\n          if (typeXhr.status === OK) {\n            typeRes = JSON.parse(typeXhr.responseText);\n            var ID = typeRes['"+s.toLowerCase()+"'].id\n            var response = undefined;\n            var xhr = new XMLHttpRequest();\n            xhr.open('GET', 'https://api.flickr.com/services/rest/?method=flickr."+i+".getPhotos&"+s.toLowerCase()+"_id='+ ID + '&format=json&api_key="+t.apiKey+"&extras=url_l&nojsoncallback=1&per_page="+t.count+"');\n            xhr.send(null);\n            xhr.onreadystatechange = function () {\n              var DONE = 4;\n              var OK = 200;\n              if (xhr.readyState === DONE) {\n                if (xhr.status === OK) {\n                  response = JSON.parse(xhr.responseText);\n                  response.photos.photo.forEach(\n                    function(item, index) {\n                      var elem = elems[index];\n                      elem.style.backgroundImage = 'url(' + item.url_l + ')';\n                    }\n                  );\n                } else {\n                  console.warn('Error: ' + xhr.status);\n                }\n              }\n            };\n          } else {\n            console.warn('Error: ' + typeXhr.status);\n          }\n        }\n      };\n      \n    })();\n    ";var o='<script id="vcv-script-'+e+'" type="text/javascript">'+l.text+"</script>";a.setAttribute("data-vcvs-html",o),a.appendChild(l),this.wrapperDiv&&this.wrapperDiv.appendChild(a)}},{key:"render",value:function(){var e=this,t=this.props,r=t.id,s=t.atts,a=t.editor,l=s.customClass,o=s.metaCustomId,c=n("./node_modules/classnames/index.js"),p={},u=["vce-flickr-widget-container"],d=["vce","vce-flickr-widget"];"string"==typeof l&&l&&u.push(l),o&&(p.id=o),d=c(d),u=c(u);var m=this.applyDO("margin"),v=this.applyDO("border padding background animation");return y["default"].createElement("div",(0,i["default"])({className:u},a,{id:"el-"+r},m),y["default"].createElement("div",(0,i["default"])({className:d},p,v,{ref:function(t){e.wrapperDiv=t}})))}}]),t}(k.elementComponent);t["default"]=w},0:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var s=n("./node_modules/vc-cake/index.js"),i=r(s),a=n("./flickrWidget/component.js"),l=r(a),o=i["default"].getService("cook").add;o(n("./flickrWidget/settings.json"),function(e){e.add(l["default"])},{css:n("./node_modules/raw-loader/index.js!./flickrWidget/styles.css"),editorCss:n("./node_modules/raw-loader/index.js!./flickrWidget/editor.css")},"")},"./flickrWidget/settings.json":function(e,t){e.exports={apiKey:{type:"string",access:"public",value:"",options:{label:"Flickr API key",descriptionHTML:'To use Flickr widget you will need to <a target="_blank" rel="noopener noreferrer" href="https://www.flickr.com/services/api/misc.api_keys.html">request your API key</a>.'}},flickrUrl:{type:"string",access:"public",value:"https://www.flickr.com/photos/rosie_hardy/",options:{label:"Flickr URL",description:"Link to a group, profile or collection."}},count:{type:"number",access:"public",value:"6",options:{label:"Picture amount"}},gap:{type:"number",access:"public",value:"1",options:{label:"Gap",description:"Enter gap in pixels (Example: 5)."}},columns:{type:"number",access:"public",value:"3",options:{label:"Number of Columns"}},shape:{type:"buttonGroup",access:"public",value:"square",options:{label:"Shape",values:[{label:"Square",value:"square",icon:"vcv-ui-icon-attribute-shape-square"},{label:"Rounded",value:"rounded",icon:"vcv-ui-icon-attribute-shape-rounded"},{label:"Round",value:"round",icon:"vcv-ui-icon-attribute-shape-round"}]}},customClass:{type:"string",access:"public",value:"",options:{label:"Extra class name",description:"Add an extra class name to the element and refer to it from Custom CSS option."}},designOptions:{type:"designOptions",access:"public",value:{},options:{label:"Design Options"}},editFormTab1:{type:"group",access:"protected",value:["apiKey","flickrUrl","count","columns","gap","shape","metaCustomId","customClass"],options:{label:"General"}},metaEditFormTabs:{type:"group",access:"protected",value:["editFormTab1","designOptions"]},relatedTo:{type:"group",access:"protected",value:["General"]},assetsLibrary:{access:"public",type:"string",value:["animate"]},metaBackendLabels:{type:"group",access:"protected",value:[{value:["flickrUrl","count","columns","gap","shape"]}]},metaCustomId:{type:"customId",access:"public",value:"",options:{label:"Element ID",description:"Apply unique Id to element to link directly to it by using #your_id (for element id use lowercase input only)."}},metaPublicJs:{access:"protected",type:"string",value:{libraries:[{libPaths:"public/dist/responsive.min.js"}]}},tag:{access:"protected",type:"string",value:"flickrWidget"}}},"./node_modules/raw-loader/index.js!./flickrWidget/editor.css":function(e,t){e.exports=".vce-flickr-widget-container {\n  min-height: 1em;\n}\n"},"./node_modules/raw-loader/index.js!./flickrWidget/styles.css":function(e,t){e.exports=".vce-flickr-widget {\n  display: block;\n  width: 100%;\n}\n"}});